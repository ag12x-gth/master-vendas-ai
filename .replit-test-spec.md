# Especifica√ß√£o de Testes - App Testing (Replit Agent)

## üéØ Objetivo
Testar o sistema de m√©tricas e performance de Agentes de IA implementado no Master IA Oficial.

## üìã Funcionalidades a Testar

### 1. API de M√©tricas por Agente
**Endpoint**: `GET /api/v1/ia/personas/{personaId}/metrics`

**Pr√©-requisitos**:
- Usu√°rio autenticado
- Agente de IA existente no sistema

**Fluxo de Teste**:
1. Fazer login com credenciais de teste
2. Obter lista de agentes via `/api/v1/ia/metrics`
3. Extrair ID do primeiro agente
4. Fazer requisi√ß√£o para `/api/v1/ia/personas/{personaId}/metrics`
5. Validar estrutura de resposta

**Resposta Esperada**:
```json
{
  "persona": {
    "id": "string",
    "name": "string",
    "model": "string",
    "provider": "string"
  },
  "metrics": {
    "totalConversations": "number",
    "activeConversations": "number",
    "totalMessages": "number",
    "recentMessages7Days": "number",
    "successRate": "number",
    "successCount": "number",
    "errorCount": "number",
    "totalAttempts": "number"
  },
  "dailyActivity": [
    {
      "date": "string",
      "count": "number"
    }
  ],
  "recentActivity": [
    {
      "id": "string",
      "level": "string",
      "message": "string",
      "createdAt": "string"
    }
  ]
}
```

**Crit√©rios de Sucesso**:
- ‚úÖ Status HTTP 200
- ‚úÖ Estrutura JSON v√°lida
- ‚úÖ Campos obrigat√≥rios presentes
- ‚úÖ M√©tricas num√©ricas n√£o-negativas

---

### 2. Aba Performance no Editor de Agentes
**URL**: `/agentes-ia/{personaId}`

**Pr√©-requisitos**:
- Usu√°rio autenticado
- Agente de IA existente

**Fluxo de Teste**:
1. Fazer login no sistema
2. Navegar para `/agentes-ia`
3. Clicar no primeiro agente dispon√≠vel
4. Verificar presen√ßa de 2 abas: "Configura√ß√µes" e "Performance"
5. Clicar na aba "Performance"
6. Validar exibi√ß√£o de componentes

**Componentes Esperados**:
- ‚úÖ 4 cards de m√©tricas:
  - Total de Conversas
  - Mensagens Enviadas
  - Taxa de Sucesso
  - Atividade Recente (7 dias)
- ‚úÖ Gr√°fico de atividade di√°ria (Recharts)
- ‚úÖ Lista de "√öltimas Atividades" (10 entradas)

**Crit√©rios de Sucesso**:
- ‚úÖ Tabs renderizadas corretamente
- ‚úÖ Aba "Performance" clic√°vel
- ‚úÖ Cards de m√©tricas exibindo dados
- ‚úÖ Gr√°fico renderizado (elemento SVG presente)
- ‚úÖ Lista de atividades vis√≠vel

---

### 3. Dashboard - Se√ß√£o AI Performance
**URL**: `/dashboard`

**Pr√©-requisitos**:
- Usu√°rio autenticado

**Fluxo de Teste**:
1. Fazer login no sistema
2. Navegar para `/dashboard`
3. Rolar at√© a se√ß√£o "Performance da IA" ou "AI Performance"
4. Validar presen√ßa de componentes

**Componentes Esperados**:
- ‚úÖ Se√ß√£o com t√≠tulo "Performance da IA" ou similar
- ‚úÖ 4 cards de m√©tricas gerais:
  - Total de Mensagens IA
  - Conversas Gerenciadas
  - Uso nos √öltimos 7 Dias
  - Taxa de Sucesso
- ‚úÖ Cada card deve exibir:
  - √çcone
  - T√≠tulo
  - Valor num√©rico
  - Descri√ß√£o/label

**Crit√©rios de Sucesso**:
- ‚úÖ Se√ß√£o vis√≠vel no dashboard
- ‚úÖ 4 cards renderizados
- ‚úÖ Dados num√©ricos exibidos
- ‚úÖ API `/api/v1/ia/metrics` retorna 200 OK

---

### 4. Gr√°fico de Atividade da IA
**URL**: `/dashboard` (dentro da se√ß√£o AI Performance)

**Pr√©-requisitos**:
- Usu√°rio autenticado
- Dados de atividade dispon√≠veis

**Fluxo de Teste**:
1. Fazer login no sistema
2. Navegar para `/dashboard`
3. Localizar se√ß√£o "Performance da IA"
4. Identificar gr√°fico de linha (Recharts)
5. Validar renderiza√ß√£o

**Componentes Esperados**:
- ‚úÖ Componente `<ResponsiveContainer>` (Recharts)
- ‚úÖ Elemento SVG do gr√°fico
- ‚úÖ Linha de dados vis√≠vel (path/curve)
- ‚úÖ Eixos X e Y renderizados
- ‚úÖ Labels dos √∫ltimos 7 dias

**Crit√©rios de Sucesso**:
- ‚úÖ Gr√°fico renderizado (classe `recharts-wrapper`)
- ‚úÖ Dados plotados (linha/curva vis√≠vel)
- ‚úÖ Tooltip funcional (ao hover)
- ‚úÖ Responsivo (adapta ao container)

---

### 5. Tabela de Top Agentes
**URL**: `/dashboard` (dentro da se√ß√£o AI Performance)

**Pr√©-requisitos**:
- Usu√°rio autenticado
- Pelo menos 1 agente cadastrado

**Fluxo de Teste**:
1. Fazer login no sistema
2. Navegar para `/dashboard`
3. Localizar tabela "Top Agentes" ou "Agentes em Destaque"
4. Validar estrutura da tabela
5. Testar navega√ß√£o clicando em um agente

**Componentes Esperados**:
- ‚úÖ Tabela com colunas:
  - Nome do Agente
  - Modelo
  - Mensagens Enviadas
- ‚úÖ At√© 5 agentes listados
- ‚úÖ Links clic√°veis para `/agentes-ia/{id}`
- ‚úÖ Ordena√ß√£o por performance (mais mensagens primeiro)

**Crit√©rios de Sucesso**:
- ‚úÖ Tabela renderizada com dados
- ‚úÖ Links funcionando (redirecionamento correto)
- ‚úÖ Dados consistentes com API
- ‚úÖ Responsiva em mobile

---

## üîê Credenciais de Teste

**Email**: [Fornecido pelo usu√°rio]  
**Senha**: [Fornecida pelo usu√°rio]

---

## üöÄ Configura√ß√£o do Ambiente

**Base URL**: http://localhost:5000  
**Framework**: Next.js 14.2.33  
**Port**: 5000  

**APIs Principais**:
- `GET /api/v1/ia/metrics` - M√©tricas gerais
- `GET /api/v1/ia/personas/{id}/metrics` - M√©tricas por agente
- `POST /api/v1/auth/login` - Autentica√ß√£o

---

## ‚úÖ Checklist de Valida√ß√£o

### Funcionalidade 1: API de M√©tricas por Agente
- [ ] Login bem-sucedido
- [ ] API retorna 200 OK
- [ ] JSON v√°lido retornado
- [ ] Campos obrigat√≥rios presentes
- [ ] M√©tricas corretas (n√£o-negativas)

### Funcionalidade 2: Aba Performance
- [ ] Navega√ß√£o para p√°gina do agente funcional
- [ ] Tabs vis√≠veis e clic√°veis
- [ ] Aba "Performance" abre corretamente
- [ ] 4 cards de m√©tricas renderizados
- [ ] Gr√°fico de atividade exibido
- [ ] Lista de atividades presente

### Funcionalidade 3: Dashboard AI Performance
- [ ] Se√ß√£o vis√≠vel no dashboard
- [ ] 4 cards de m√©tricas gerais renderizados
- [ ] Valores num√©ricos corretos
- [ ] API de m√©tricas respondendo

### Funcionalidade 4: Gr√°fico de Atividade
- [ ] Gr√°fico Recharts renderizado
- [ ] Linha de dados vis√≠vel
- [ ] Eixos X e Y presentes
- [ ] Tooltip funcional

### Funcionalidade 5: Tabela Top Agentes
- [ ] Tabela renderizada
- [ ] Pelo menos 1 agente listado
- [ ] Links clic√°veis
- [ ] Redirecionamento correto

---

## üêõ Problemas Conhecidos

‚úÖ **Todos os bugs SQL foram corrigidos**:
- SQL join sem alias ‚Üí Corrigido
- Logs n√£o filtrados por agente ‚Üí Corrigido
- Uso incorreto de `ANY($1)` ‚Üí Corrigido usando `inArray()`

---

## üìä Resultado Esperado

**Taxa de Sucesso Esperada**: 100% (5/5 funcionalidades)  
**Status das APIs**: Todas retornando 200 OK  
**Componentes UI**: Todos renderizando corretamente  
**Navega√ß√£o**: Fluxos completos funcionais
